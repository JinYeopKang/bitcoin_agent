# 3. `docs/03_prompt_guide.md` (프롬프트 가이드)

각 Agent의 프롬프트가 왜 그렇게 작성되었는지, 어떤 역할을 하는지 설명하는 문서입니다. (Req 4)

(파일 경로: `docs/03_prompt_guide.md`)

# 3. 프롬프트 엔지니어링 가이드

본 Agent의 성능은 `prompts/` 디렉터리의 프롬프트 품질에 크게 좌우됩니다. 각 프롬프트는 명확한 "역할"과 "규칙"을 가집니다.

## 3.1. `prompts/planner.md` (지휘자)

* **역할:** "수석 애널리스트"
* **핵심 기능:** 의사 결정 (Decision Making)
* **프롬프트 특징:**
    1.  **도구 명시:** 사용할 수 있는 도구 3가지(`get_ohlcv_data`, `calculate_technical_indicators`, `Google Search`)를 명확히 알려줍니다.
    2.  **상태 기반 규칙 (매우 중요):**
        * **초기 단계:** `query`만 있을 땐 도구를 "반드시" 호출하도록 지시합니다.
        * **분석 위임:** 데이터가 다 모이면 "더 이상 도구를 호출하지 말라"고 지시하여 `analysis` 노드로 넘어가도록 유도합니다.
        * **검토 단계:** `reflection`을 받았을 때의 분기 처리(추가 도구 / 수정 위임 / 최종 승인)를 명확하게 정의합니다.
    3.  **종료 조건:** `final_report`를 생성하면 그래프가 종료됨을 인지시킵니다.

## 3.2. `prompts/analysis.md` (작성자)

* **역할:** "전문 암호화폐 애널리스트" (실무자)
* **핵심 기능:** 작문 (Generation)
* **프롬프트 특징:**
    1.  **도구 사용 금지:** 이 Agent는 도구를 모릅니다. 오직 주어진 데이터(`input_data`)로 글만 씁니다. (역할 분리)
    2.  **데이터 근거:** [기술적 분석]과 [시장 정서]를 "모두 근거로 사용"하라고 지시하여 편향을 방지합니다.
    3.  **수정 시나리오:** `[수정 지시]`가 입력될 경우, [기존 초안]을 "새로운 전체 초안"으로 수정하라고 지시하여 `draft_analysis`를 덮어쓰도록 합니다.
    4.  **출력 형식 고정:** "오직 한국어 분석 초안 본문"만 응답하게 하여, `state['draft_analysis']`에 "분석 초안입니다:" 같은 불필요한 텍스트가 저장되는 것을 방지합니다.

## 3.3. `prompts/reflection.md` (비평가)

* **역할:** "수석 애널리스트" 또는 "리스크 관리 매니저"
* **핵심 기능:** 비평 (Critique)
* **프롬프트 특징:**
    1.  **명확한 검토 기준:** (논리적 비약, 데이터 누락, 어조, 완성도) 4가지 기준을 제시하여 일관된 품질의 비평을 유도합니다.
    2.  **직접 수정 금지 (매우 중요):** "초안을 *절대* 직접 수정하지 마십시오"라고 강조하여, `analysis_agent`의 역할을 침범하지 않도록 합니다.
    3.  **종료 신호 정의:** "초안이 완벽할 경우"의 특정 응답(`"매우 훌륭함..."`)을 정의했습니다. 이는 `planner`가 `final_report`를 작성할지 결정하는 중요한 신호(Signal)가 됩니다.